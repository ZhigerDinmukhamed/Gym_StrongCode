# –¢–µ—Å—Ç—ã

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞

### Unit —Ç–µ—Å—Ç—ã (tests/unit/)
–¢–µ—Å—Ç—ã –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤:

- `user_repository_test.go` - —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π —é–∑–µ—Ä–æ–≤
- `booking_repository_test.go` - –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è
- `repository_test.go` - –∑–∞–ª—ã, –ø–æ–¥–ø–∏—Å–∫–∏ –∏ —Ç–¥
- `auth_service_test.go` - –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
- `service_test.go` - –æ—Å—Ç–∞–ª—å–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã
- `middleware_test.go` - middleware (auth, admin, rate limit)

### –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ (tests/integration/)
–ü—Ä–æ–≤–µ—Ä–∫–∞ API:

- `api_test.go` - –æ—Å–Ω–æ–≤–Ω—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã
- `auth_test.go` - –ª–æ–≥–∏–Ω/—Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è
- `user_test.go` - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏
- `edge_cases_test.go` - –≥—Ä–∞–Ω–∏—á–Ω—ã–µ —Å–ª—É—á–∞–∏
- `handlers_test.go` - CRUD –¥–ª—è gym, class, booking, trainer, membership
- `additional_handlers_test.go` - –æ—Å—Ç–∞–ª—å–Ω—ã–µ —Ö–µ–Ω–¥–ª–µ—Ä—ã

### –£—Ç–∏–ª–∏—Ç—ã (tests/testutils/)
–•–µ–ª–ø–µ—Ä—ã:

- `database.go` - in-memory –ë–î
- `fixtures.go` - —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ

## –ö–∞–∫ –∑–∞–ø—É—Å–∫–∞—Ç—å

–í—Å–µ:
```bash
go test ./tests/...
```

–¢–æ–ª—å–∫–æ unit:
```bash
go test ./tests/unit/...
```

–¢–æ–ª—å–∫–æ integration:
```bash
go test ./tests/integration/...
```

–° –ø–æ–∫—Ä—ã—Ç–∏–µ–º:
```bash
go test -coverprofile=coverage.out -coverpkg ./internal/... ./tests/...
go tool cover -func coverage.out
```

–û–¥–∏–Ω —Ç–µ—Å—Ç:
```bash
go test -v -run TestUserRepository_Create ./tests/unit/...
```

## –ü–æ–∫—Ä—ã—Ç–∏–µ —Ç–µ—Å—Ç–∞–º–∏

### Unit-—Ç–µ—Å—Ç—ã –ø—Ä–æ–≤–µ—Ä—è—é—Ç:
- ‚úÖ CRUD –æ–ø–µ—Ä–∞—Ü–∏–∏ –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è—Ö
- ‚úÖ –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫—É –≤ —Å–µ—Ä–≤–∏—Å–∞—Ö
- ‚úÖ –†–∞–±–æ—Ç—É —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫—É –æ—à–∏–±–æ–∫
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—é –¥–∞–Ω–Ω—ã—Ö

### –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ–≤–µ—Ä—è—é—Ç:
- ‚úÖ HTTP —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã
- ‚úÖ –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è

**–¢–µ–∫—É—â–µ–µ: 71.7%**
- Unit —Ç–µ—Å—Ç—ã: 73.8%
- Integration: 62.3%

### –ß—Ç–æ –ø–æ–∫—Ä—ã—Ç–æ:

**Handlers (60-100%)**
- Auth, Booking, Class, Gym, Membership, Payment, Trainer, User

**Middleware (100%)**
- AuthMiddleware, AdminOnly, RateLimitMiddleware, LoggingMiddleware

**Repositories (70-100%)**
- User, Booking, Class, Gym, Membership, Payment, Trainer

**Services (70-100%)**
- Auth, Booking, Class, Gym, Membership, Payment, Trainer, User

### –ù–µ –ø–æ–∫—Ä—ã—Ç–æ:
- Cache (Redis) - –Ω—É–∂–Ω—ã –º–æ–∫–∏
- Workers - —Ñ–æ–Ω–æ–≤—ã–µ –∑–∞–¥–∞—á–∏
- Config
- Database init–∫** - require.NoError() –¥–ª—è –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π, assert.Error() –¥–ª—è –æ–∂–∏–¥–∞–µ–º—ã—Ö
8. **–ù–µ–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å** - —Ç–µ—Å—Ç—ã –º–æ–∂–Ω–æ –∑–∞–ø—É—Å–∫–∞—Ç—å –≤ –ª—é–±–æ–º –ø–æ—Ä—è–¥–∫–µ

### üîß –ß—Ç–æ –º–æ–∂–Ω–æ —É–ª—É—á—à–∏—Ç—å:
1. –î–æ–±–∞–≤–∏—Ç—å –±–µ–Ω—á–º–∞—Ä–∫–∏ –¥–ª—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
2. –†–∞—Å—à–∏—Ä–∏—Ç—å –ø–æ–∫—Ä—ã—Ç–∏–µ edge cases
3. –î–æ–±–∞–≤–∏—Ç—å —Ç–µ—Å—Ç—ã –¥–ª—è –∫—ç—à–∞ Redis (–µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è)
4. –î–æ–±–∞–≤–∏—Ç—å E2E —Ç–µ—Å—Ç—ã —Å —Ä–µ–∞–ª—å–Ω—ã–º —Å–µ—Ä–≤–µ—Ä–æ–º
5. –¢–µ—Å—Ç—ã –¥–ª—è worker'–æ–≤ –∏ —Ñ–æ–Ω–æ–≤—ã—Ö –∑–∞–¥–∞—á
6. –¢–µ—Å—Ç—ã –¥–ª—è middleware (rate limiting)
7. –ù–∞–≥—Ä—É–∑–æ—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

## –ü—Ä–∏–º–µ—Ä –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–æ–≤–æ–≥–æ —Ç–µ—Å—Ç–∞

```go
fun–ó–∞–º–µ—Ç–∫–∏

–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è:
- In-memory SQLite –¥–ª—è —Ç–µ—Å—Ç–æ–≤
- testify –¥–ª—è –∞—Å—Å–µ—Ä—Ç–æ–≤
- –ö–∞–∂–¥—ã–π —Ç–µ—Å—Ç –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω (—Å–≤–æ—è –ë–î)
- Cleanup —á–µ—Ä–µ–∑ t.Cleanup()

–ß—Ç–æ –¥–æ–±–∞–≤–∏—Ç—å –ø–æ—Ç–æ–º:
- Redis —Ç–µ—Å—Ç—ã (–Ω—É–∂–Ω—ã –º–æ–∫–∏)
- Workers
- –ë–µ–Ω—á–º–∞—Ä–∫–∏
- –ù–∞–≥—Ä—É–∑–æ—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ